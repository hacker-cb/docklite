---
description: Traefik Dashboard access, routing priorities, and URI conventions
---

# Traefik Dashboard Access and Routing

## Dashboard Access

**URL:** `http://hostname/traefik/` (NOT `/dashboard/`)

- **Frontend button:** "Traefik" (admin-only)
- **Function:** `openTraefik()` in [frontend/src/App.vue](mdc:frontend/src/App.vue)
- **Authentication:** ForwardAuth via `/api/auth/verify-admin` (admin-only)
- **Access:** JWT token in cookies required

## URI Convention

**IMPORTANT:** Use `/traefik/` everywhere, NOT `/dashboard/`

- ✅ Correct: `http://hostname/traefik/`
- ❌ Wrong: `http://hostname/dashboard/`

The internal Traefik API expects `/dashboard`, but we expose it as `/traefik` externally using `replacepathregex` middleware.

## Traefik Routing Priorities

Configured in [docker-compose.yml](mdc:docker-compose.yml):

1. **Priority 250** (HIGHEST): `traefik-api` router
   - Rule: `Host() && PathPrefix(/api) && (Path(/api/version) || Path(/api/overview) || ...)`
   - Service: `api@internal`
   - Purpose: Traefik internal API endpoints
   - Middleware: `admin-auth`

2. **Priority 200**: `docklite-backend` router
   - Rule: `PathPrefix(/api) || PathPrefix(/docs) || PathPrefix(/openapi.json)`
   - Service: `docklite-backend`
   - Purpose: DockLite API endpoints

3. **Priority 50**: `traefik-ui` router
   - Rule: `Host() && PathPrefix(/traefik)`
   - Service: `api@internal`
   - Purpose: Traefik Dashboard UI
   - Middleware: `admin-auth,traefik-stripprefix`

4. **Priority 1**: `docklite-frontend` router
   - Rule: `PathPrefix(/)`
   - Service: `docklite-frontend`
   - Purpose: DockLite frontend (catch-all)

## Path Rewriting

The `traefik-stripprefix` middleware converts `/traefik` → `/dashboard`:

```yaml
- "traefik.http.middlewares.traefik-stripprefix.replacepathregex.regex=^/traefik(.*)"
- "traefik.http.middlewares.traefik-stripprefix.replacepathregex.replacement=/dashboard$$1"
```

This is necessary because Traefik's `api@internal` service expects the `/dashboard` prefix.

## Access URLs in Scripts

When displaying Traefik Dashboard URL in scripts:

```bash
# Bash
log_info "Traefik: ${COLOR_CYAN}$(get_access_url "/traefik")${COLOR_NC}"

# Python
log_info(f"Traefik: [cyan]{get_access_url('/traefik')}[/cyan]")
```

## Testing Access

```bash
# Check main site
curl http://hostname/

# Check DockLite API
curl http://hostname/api/presets/categories

# Check Traefik Dashboard (requires admin auth)
curl http://hostname/traefik/

# Check Traefik API (requires admin auth)
curl http://hostname/api/version
```

## Common Issues

**Issue:** Infinite redirects or 401 errors
**Cause:** Traefik API router intercepting DockLite API requests
**Solution:** Ensure `traefik-api` router has HIGHEST priority (250+) and specific path matching

**Issue:** 404 on Traefik Dashboard
**Cause:** Using `/dashboard/` instead of `/traefik/`
**Solution:** Always use `/traefik/` URI

**Issue:** API requests fail from Traefik Dashboard
**Cause:** `traefik-api` router not matching Traefik-specific endpoints
**Solution:** Ensure router includes all necessary paths: `/api/version`, `/api/overview`, `/api/http`, etc.
