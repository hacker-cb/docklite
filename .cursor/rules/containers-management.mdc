---
description: Docker containers management module - API endpoints, UI components, and patterns
---

# Containers Management Module

## Overview

Full-featured Docker containers management module for DockLite admin panel with real-time monitoring, logs viewing, and container lifecycle operations.

**Access:** Admin-only  
**URL:** http://hostname/containers (via Containers button in navigation)

## Backend API

**Location:** [backend/app/api/containers.py](mdc:backend/app/api/containers.py)  
**Service:** [backend/app/services/docker_service.py](mdc:backend/app/services/docker_service.py)

### Endpoints

All endpoints require admin authentication:

```
GET    /api/containers              - List all containers (with ?all=true/false)
GET    /api/containers/{id}         - Get container details
POST   /api/containers/{id}/start   - Start container
POST   /api/containers/{id}/stop    - Stop container
POST   /api/containers/{id}/restart - Restart container
DELETE /api/containers/{id}         - Remove container
GET    /api/containers/{id}/logs    - Get logs (with ?tail=100)
GET    /api/containers/{id}/stats   - Get resource usage stats
```

### Docker Service Implementation

Uses Docker CLI via subprocess (not docker-py) for better compatibility:

```python
from app.services.docker_service import DockerService

service = DockerService()
containers = service.list_all_containers(all=True)  # Returns list of dicts
```

**Important:** Docker CLI must be installed in backend container (added to Dockerfile).

## Frontend UI

**Location:** [frontend/src/views/ContainersView.vue](mdc:frontend/src/views/ContainersView.vue)  
**Route:** `/containers` (admin-only, see [frontend/src/router.js](mdc:frontend/src/router.js))

### Features

**Filters:**
- All - Show all containers
- System (badge: SYSTEM) - DockLite infrastructure (traefik, backend, frontend)
- Projects - User deployed project containers

**Actions:**
- üü¢ Start - Start stopped container
- üî¥ Stop - Stop running container  
- üîÑ Restart - Restart container
- üìú Logs - View container logs (modal dialog with tail option)
- üóëÔ∏è Remove - Delete container (with confirmation)

**Display:**
- Container name, image, status
- Created/Started timestamps
- SYSTEM badge for infrastructure
- Color-coded status indicators
- Responsive table with PrimeVue DataTable

## API Client

**Location:** [frontend/src/api.js](mdc:frontend/src/api.js)

```javascript
import { containersApi } from '@/api'

// List containers
const containers = await containersApi.getAll(true)

// Control container
await containersApi.start(containerId)
await containersApi.stop(containerId)
await containersApi.restart(containerId)

// Get logs
const logs = await containersApi.getLogs(containerId, { tail: 100 })

// Remove
await containersApi.remove(containerId)
```

## Navigation Integration

**Location:** [frontend/src/App.vue](mdc:frontend/src/App.vue)

Containers button in main navigation (admin-only):

```vue
<Button 
  v-if="currentUser?.is_admin"
  label="Containers"
  icon="pi pi-box" 
  @click="router.push('/containers')"
/>
```

## Docker Requirements

### Backend Container Setup

Docker CLI must be installed in backend container:

```dockerfile
# Install Docker CLI (see backend/Dockerfile)
RUN apt-get update && apt-get install -y docker-ce-cli
```

Docker socket must be mounted:

```yaml
# In docker-compose.yml
services:
  backend:
    volumes:
      - /var/run/docker.sock:/var/run/docker.sock
```

## Security

**Admin-only Access:**
- All `/api/containers/*` endpoints check `is_admin` flag
- Frontend route has `meta: { requiresAdmin: true }`
- Navigation button only visible to admins

**System Container Protection:**
- System containers (docklite-backend, docklite-frontend, docklite-traefik) are protected
- **BLOCKED operations:** Stop, Restart, Remove (would break DockLite)
- **ALLOWED operations:** Start (recovery), Logs, Stats (safe)
- Backend returns 403 Forbidden for blocked operations
- Frontend disables Stop/Restart/Remove buttons with tooltips
- See [SYSTEM_CONTAINERS_PROTECTION.md](mdc:SYSTEM_CONTAINERS_PROTECTION.md)

**Permissions:**
- Backend container needs access to Docker socket
- Container operations run with Docker daemon privileges

## Testing

**Backend:** [backend/tests/test_api/test_containers.py](mdc:backend/tests/test_api/test_containers.py)  
**Frontend:** [frontend/tests/ContainersView.test.js](mdc:frontend/tests/ContainersView.test.js)

```bash
# Run backend tests
./docklite test-backend -k test_containers

# All tests
./docklite test
```

**Coverage:** 17 backend tests, 20+ frontend tests

## Common Patterns

### Check Container Status

```python
# Backend
service = DockerService()
container = service.get_container('container_id')
status = container['status']  # 'running', 'exited', 'paused', etc.
```

```javascript
// Frontend
const container = await containersApi.getById(containerId)
const isRunning = container.status.toLowerCase().includes('running')
```

### Group by Type

Containers are categorized:
- **SYSTEM**: `docklite-traefik`, `docklite-backend`, `docklite-frontend`
- **PROJECTS**: All other containers

```javascript
const group = container.name.startsWith('docklite-') ? 'SYSTEM' : 'PROJECTS'
```

## Troubleshooting

### "Failed to connect to Docker"

Check Docker socket mount and permissions:

```bash
# Verify socket mounted
docker exec docklite-backend ls -la /var/run/docker.sock

# Test Docker CLI
docker exec docklite-backend docker ps
```

### Container operations timeout

Increase timeout in docker_service.py:

```python
subprocess.run([...], timeout=30)  # Default: 10s
```

## Related Files

- [backend/app/services/docker_service.py](mdc:backend/app/services/docker_service.py) - Docker CLI wrapper
- [backend/app/api/containers.py](mdc:backend/app/api/containers.py) - API endpoints
- [frontend/src/views/ContainersView.vue](mdc:frontend/src/views/ContainersView.vue) - Main UI
- [frontend/src/api.js](mdc:frontend/src/api.js) - API client
- [backend/tests/test_api/test_containers.py](mdc:backend/tests/test_api/test_containers.py) - Tests
- [CONTAINERS_FEATURE_COMPLETE.md](mdc:CONTAINERS_FEATURE_COMPLETE.md) - Feature summary
